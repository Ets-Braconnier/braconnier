<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Bois | Ets Braconnier</title>
  <meta name="description" content="Bois et panneaux disponibles chez Ets Braconnier." />
  <meta name="robots" content="index,follow" />

  <link rel="stylesheet" href="style.css">
</head>

<body class="page-bois">

  <div class="page-scale">

    <!-- HEADER -->
    <header>
      <div class="wrap topbar">

        <div class="brand">
          <div class="logo">
            <img id="logoMain" alt="Ets Braconnier">
            <small>Matériaux de construction – articles professionnels et de bricolage</small>
          </div>
        </div>

        <div class="header-right">
          <div class="quicklinks">
            <a href="/Avis/Avis1.php">Votre avis</a>
            <a href="/rgpd.pdf">RGPD</a>
          </div>
        </div>

      </div>

      <div class="hero-layout">

        <nav class="main-nav">
          <button class="menu-toggle">☰ Menu</button>
          <ul class="menu">
            <li><a href="index.html">Accueil</a></li>
            <li><a href="calculs.html">Calculs</a></li>
            <li><a href="presentation.html">Présentation</a></li>
            <li><a href="produits.html">Produits</a></li>
            <li><a href="promotions.html">Promotions</a></li>
            <li><a href="contact.html">Contacts</a></li>
          </ul>
        </nav>

        <img id="heroImg" class="hero-img" alt="Magasin – Ets Braconnier">

        <iframe class="map"
          src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d5145.2121350771895!2d5.25321!3d49.84985900000001!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47ea808d6bb9e87f%3A0xf00dd4deebbf1048!2sEts%20Braconnier!5e0!3m2!1sfr!2sbe!4v1770570919392!5m2!1sfr!2sbe"
          loading="lazy">
        </iframe>

      </div>
    </header>


    <!-- MAIN -->
    <main>

      <div class="wrap">
        <section class="headline">
          <h1>Bois</h1>
        </section>
      </div>

      <div class="iframe-full">
        <iframe id="boisFrame" src="https://ets-braconnier.github.io/bois/"
          style="border:none; display:block; height:900px;" scrolling="no">
        </iframe>
      </div>

      <script>
        (function () {
          const ORIGIN_OK = "https://ets-braconnier.github.io";
          const frame = document.getElementById("boisFrame");
          if (!frame) return;

          // Valeurs de TON CSS global :
          const SCALE = 1.333333; // .page-bois .iframe-full iframe { transform: scale(...) }
          const ZOOM = 0.75;      // .page-scale { zoom: 0.75 }
          const FACTOR = SCALE * ZOOM; // ~ 1.0 chez toi

          let lastApplied = 0;

          // Anti-boucle : si trop d'updates en peu de temps, on temporise
          let burstCount = 0;
          let burstWindowStart = performance.now();
          let pausedUntil = 0;

          function applyHeight(rawHeight) {
            const now = performance.now();
            if (now < pausedUntil) return;

            // fenêtre de 2s
            if (now - burstWindowStart > 2000) {
              burstWindowStart = now;
              burstCount = 0;
            }

            // Hauteur minimale "layout" pour que le visuel (après scale+zoom) couvre le contenu.
            // +40px de marge pour éviter les micro-coupes.
            let target = Math.ceil((rawHeight / FACTOR) + 40);

            // garde-fous
            if (!Number.isFinite(target) || target < 300) return;
            target = Math.min(target, 120000); // évite les explosions

            // ignore les micro-variations
            if (Math.abs(target - lastApplied) < 8) return;

            // si ça pousse en boucle, on freine
            burstCount++;
            if (burstCount > 25) {
              pausedUntil = now + 1500; // pause 1,5s
              burstCount = 0;
              return;
            }

            lastApplied = target;
            frame.style.height = target + "px";
          }

          window.addEventListener("message", function (e) {
            if (e.origin !== ORIGIN_OK) return;
            if (!e.data || e.data.type !== "resize") return;

            const raw = Number(e.data.height);
            if (!Number.isFinite(raw) || raw < 200) return;

            // application + recalage (images/fonts)
            applyHeight(raw);
            requestAnimationFrame(() => applyHeight(raw));
            setTimeout(() => applyHeight(raw), 250);
            setTimeout(() => applyHeight(raw), 900);
          });
        })();
      </script>

    </main>


    <!-- FOOTER -->
    <footer>
      <div class="wrap">
        <div class="footerbar"></div>
      </div>
    </footer>

  </div>


  <!-- logo + hero -->
  <script>
    const ASSETS = {
      logoMain: "images-site/logo.jpg",
      hero: "images-site/magasin.jpg"
    };

    const logo = document.getElementById("logoMain");
    const hero = document.getElementById("heroImg");
    if (logo) logo.src = ASSETS.logoMain;
    if (hero) hero.src = ASSETS.hero;
  </script>

  <!-- menu mobile -->
  <script>
    const toggle = document.querySelector(".menu-toggle");
    const menu = document.querySelector(".menu");

    if (toggle && menu) {
      toggle.addEventListener("click", () => {
        menu.classList.toggle("open");
      });
    }
  </script>

</body>

</html>